package com.farmxchain.backend.contracts;

import java.math.BigInteger;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;

import org.web3j.abi.TypeReference;
import org.web3j.abi.datatypes.Function;
import org.web3j.abi.datatypes.Type;
import org.web3j.abi.datatypes.generated.Uint256;
import org.web3j.abi.datatypes.Utf8String;
import org.web3j.abi.datatypes.Address;
import org.web3j.crypto.Credentials;
import org.web3j.protocol.Web3j;
import org.web3j.protocol.core.RemoteCall;
import org.web3j.protocol.core.methods.response.TransactionReceipt;
import org.web3j.tx.Contract;
import org.web3j.tx.gas.ContractGasProvider;
import org.web3j.tx.gas.DefaultGasProvider;

@SuppressWarnings("rawtypes")
public class CropRegistry extends Contract {

    public static final String BINARY = "608060405234801561001057600080fd5b50610e59806100206000396000f3fe608060405234801561001057600080fd5b506004361061004c5760003560e01c8063509355221461005157806370c9f1a51461006d5780638bc7fa9c146100a1578063dfd55a2c146100d5575b600080fd5b61006b6004803603810190610066919061084c565b6100f3565b005b61008760048036038101906100829190610959565b6101ee565b604051610098959493929190610a14565b60405180910390f35b6100bb60048036038101906100b69190610959565b610444565b6040516100cc959493929190610a14565b60405180910390f35b6100dd6106ec565b6040516100ea9190610a83565b60405180910390f35b6001600081548092919061010690610acd565b91905055506040518060a0016040528060015481526020018581526020018481526020018381526020018281525060008060015481526020019081526020016000206000820151816000015560208201518160010190816101679190610d21565b50604082015181600201908161017d9190610d21565b5060608201518160030190816101939190610d21565b5060808201518160040190816101a99190610d21565b509050507f7394badce61f59305750049b6dc935fadc67c6e8ec4ac38f6bbd8949c0583955600154856040516101e0929190610df3565b60405180910390a150505050565b600060205280600052604060002060009150905080600001549080600101805461021790610b44565b80601f016020809104026020016040519081016040528092919081815260200182805461024390610b44565b80156102905780601f1061026557610100808354040283529160200191610290565b820191906000526020600020905b81548152906001019060200180831161027357829003601f168201915b5050505050908060020180546102a590610b44565b80601f01602080910402602001604051908101604052809291908181526020018280546102d190610b44565b801561031e5780601f106102f35761010080835404028352916020019161031e565b820191906000526020600020905b81548152906001019060200180831161030157829003601f168201915b50505050509080600301805461033390610b44565b80601f016020809104026020016040519081016040528092919081815260200182805461035f90610b44565b80156103ac5780601f10610381576101008083540402835291602001916103ac565b820191906000526020600020905b81548152906001019060200180831161038f57829003601f168201915b5050505050908060040180546103c190610b44565b80601f01602080910402602001604051908101604052809291908181526020018280546103ed90610b44565b801561043a5780601f1061040f5761010080835404028352916020019161043a565b820191906000526020600020905b81548152906001019060200180831161041d57829003601f168201915b5050505050905085565b600060608060608060008060008881526020019081526020016000206040518060a00160405290816000820154815260200160018201805461048590610b44565b80601f01602080910402602001604051908101604052809291908181526020018280546104b190610b44565b80156104fe5780601f106104d3576101008083540402835291602001916104fe565b820191906000526020600020905b8154815290600101906020018083116104e157829003601f168201915b5050505050815260200160028201805461051790610b44565b80601f016020809104026020016040519081016040528092919081815260200182805461054390610b44565b80156105905780601f1061056557610100808354040283529160200191610590565b820191906000526020600020905b81548152906001019060200180831161057357829003601f168201915b505050505081526020016003820180546105a990610b44565b80601f01602080910402602001604051908101604052809291908181526020018280546105d590610b44565b80156106225780601f106105f757610100808354040283529160200191610622565b820191906000526020600020905b81548152906001019060200180831161060557829003601f168201915b5050505050815260200160048201805461063b90610b44565b80601f016020809104026020016040519081016040528092919081815260200182805461066790610b44565b80156106b45780601f10610689576101008083540402835291602001916106b4565b820191906000526020600020905b81548152906001019060200180831161069757829003601f168201915b505050505081525050905080600001518160200151826040015183606001518460800151955095509550955095505091939590929450565b60015481565b6000604051905090565b600080fd5b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b61075982610710565b810181811067ffffffffffffffff8211171561077857610777610721565b5b80604052505050565b600061078b6106f2565b90506107978282610750565b919050565b600067ffffffffffffffff8211156107b7576107b6610721565b5b6107c082610710565b9050602081019050919050565b82818337600083830152505050565b60006107ef6107ea8461079c565b610781565b90508281526020810184848401111561080b5761080a61070b565b5b6108168482856107cd565b509392505050565b600082601f83011261083357610832610706565b5b81356108438482602086016107dc565b91505092915050565b60008060008060808587031215610866576108656106fc565b5b600085013567ffffffffffffffff81111561088457610883610701565b5b6108908782880161081e565b945050602085013567ffffffffffffffff8111156108b1576108b0610701565b5b6108bd8782880161081e565b935050604085013567ffffffffffffffff8111156108de576108dd610701565b5b6108ea8782880161081e565b925050606085013567ffffffffffffffff81111561090b5761090a610701565b5b6109178782880161081e565b91505092959194509250565b6000819050919050565b61093681610923565b811461094157600080fd5b50565b6000813590506109538161092d565b92915050565b60006020828403121561096f5761096e6106fc565b5b600061097d84828501610944565b91505092915050565b61098f81610923565b82525050565b600081519050919050565b600082825260208201905092915050565b60005b838110156109cf5780820151818401526020810190506109b4565b60008484015250505050565b60006109e682610995565b6109f081856109a0565b9350610a008185602086016109b1565b610a0981610710565b840191505092915050565b600060a082019050610a296000830188610986565b8181036020830152610a3b81876109db565b90508181036040830152610a4f81866109db565b90508181036060830152610a6381856109db565b90508181036080830152610a7781846109db565b90509695505050505050565b6000602082019050610a986000830184610986565b92915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b6000610ad882610923565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8203610b0a57610b09610a9e565b5b600182019050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b60006002820490506001821680610b5c57607f821691505b602082108103610b6f57610b6e610b15565b5b50919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b600060088302610bd77fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82610b9a565b610be18683610b9a565b95508019841693508086168417925050509392505050565b6000819050919050565b6000610c1e610c19610c1484610923565b610bf9565b610923565b9050919050565b6000819050919050565b610c3883610c03565b610c4c610c4482610c25565b848454610ba7565b825550505050565b600090565b610c61610c54565b610c6c818484610c2f565b505050565b5b81811015610c9057610c85600082610c59565b600181019050610c72565b5050565b601f821115610cd557610ca681610b75565b610caf84610b8a565b81016020851015610cbe578190505b610cd2610cca85610b8a565b830182610c71565b50505b505050565b600082821c905092915050565b6000610cf860001984600802610cda565b1980831691505092915050565b6000610d118383610ce7565b9150826002028217905092915050565b610d2a82610995565b67ffffffffffffffff811115610d4357610d42610721565b5b610d4d8254610b44565b610d58828285610c94565b600060209050601f831160018114610d8b5760008415610d79578287015190505b610d838582610d05565b865550610deb565b601f198416610d9986610b75565b60005b82811015610dc157848901518255600182019150602085019450602081019050610d9c565b86831015610dde5784890151610dda601f891682610ce7565b8355505b6001600288020188555050505b505050505050565b6000604082019050610e086000830185610986565b8181036020830152610e1a81846109db565b9050939250505056fea2646970667358221220f950c519ca9165e48a06a138a84e755ddc219a315e77abe2f3461ff95f05bc3c64736f6c63430008140033"; // paste full BIN here

    protected CropRegistry(String contractAddress, Web3j web3j, Credentials credentials, ContractGasProvider contractGasProvider) {
        super(BINARY, contractAddress, web3j, credentials, contractGasProvider);
    }

    public static CropRegistry load(String contractAddress, Web3j web3j, Credentials credentials, ContractGasProvider contractGasProvider) {
        return new CropRegistry(contractAddress, web3j, credentials, contractGasProvider);
    }

    public static CropRegistry load(String contractAddress, Web3j web3j, Credentials credentials) {
        return new CropRegistry(contractAddress, web3j, credentials, new DefaultGasProvider());
    }

    // Register crop on blockchain
    public RemoteCall<TransactionReceipt> registerCrop(String cropName, String farmerId, String harvestDate, String qualityData) {
        final Function function = new Function(
                "registerCrop",
                Arrays.asList(
                        new Utf8String(cropName),
                        new Utf8String(farmerId),
                        new Utf8String(harvestDate),
                        new Utf8String(qualityData)
                ),
                Collections.emptyList()
        );
        return executeRemoteCallTransaction(function);
    }

    // Get total crops
    public RemoteCall<BigInteger> cropCount() {
        final Function function = new Function(
                "cropCount",
                Collections.emptyList(),
                Arrays.asList(new TypeReference<Uint256>() {})
        );
        return executeRemoteCallSingleValueReturn(function, BigInteger.class);
    }

    public RemoteCall<TransactionReceipt> transferOwnership(BigInteger id, String newOwner) {
        final Function function = new Function(
                "transferOwnership",
                Arrays.asList(new Uint256(id), new Address(newOwner)),
                Collections.emptyList()
        );
        return executeRemoteCallTransaction(function);
    }

    // Get crop by ID
    public RemoteCall<List<Type>> getCrop(BigInteger id) {
        final Function function = new Function(
                "getCrop",
                Arrays.asList(new Uint256(id)),
                Arrays.asList(
                        new TypeReference<Uint256>() {},
                        new TypeReference<Utf8String>() {},
                        new TypeReference<Utf8String>() {},
                        new TypeReference<Utf8String>() {},
                        new TypeReference<Utf8String>() {},
                        new TypeReference<Address>() {}
                )
        );
        return executeRemoteCallMultipleValueReturn(function);
    }

}
